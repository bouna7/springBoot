je vais le code complet avec nouveau version